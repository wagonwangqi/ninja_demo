<#include "/mag/gaia/staff/views/layout/staff_layout.ftl.html" />
<#macro title>StaffDashbard</#macro>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <script>
        $("#tableType").change(function () {
            let val = $(this).val();
            let val0 =$("#tableType0").val();
            console.log(val0);
            console.log(val);
            $("#tbody-result").find("tr").remove();
            let tbody=window.document.getElementById("tbody-result");
            $.ajax({
                async: false,
                url: "/staff/getSection/"+${session.id}+"",
                type: "POST",
                data: {
                    "courseId": val0,
                    "chapterId":val
                },
                success: function (data) {
                    let jsons=data.sectionList;
                    let str="";
                    for(let i in jsons){
                        str+="<tr>"+
                            "<td>"+jsons[i].id+"</td>"+
                            "<td>"+jsons[i].sectionName+"</td>"+
                            "<td>"+"<a href='/staff/editChapterName/"+jsons[i].id+"/${session.id}'>编辑</a>"+"</td>"+
                            "<td>"+"<a href='/staff/editSection/"+jsons[i].id+"/${session.id}'>编辑</a>"+"</td>"+
                            "<td>"+"<a href='/staff/editHomework/"+jsons[i].id+"/${session.id}'>编辑</a>"+"</td>"+
                            "</tr>";
                    }
                    tbody.innerHTML =str;
                },
                error: function () {
                    console.log("failed");
                }
            });
        });
    </script>

</head>
<#macro body>
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">作业管理</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
            <select id="tableType0" >
                <option selected="selected">请选择课程</option>
                <#list courseList as courses>
                <option value="${courses.couId}">${courses.couName}</option>
            </#list>
            </select>
            <select id="tableType" >
                <option selected="selected">请选择章节</option>
                <#list chapterList as chapters>
                <option value="${chapters.id}">${chapters.chapterName}</option>
            </#list>
            </select>
            <button type="button" class="btn btn-sm btn-outline-secondary"><a
                    href="/staff/addSection/${session.id}">添加作业</a></button>
        </div>
    </div>
</div>
<div class="table-responsive">
    <table class="table table-striped table-sm"  id="table-result">
        <thead>
        <tr>
            <th>第一章</th>
            <th>作业名称</th>
            <th>作业内容</th>
            <th>开始时间</th>
            <th>截止时间</th>
            <th>删除</th>
        </tr>
        </thead>
        <tbody  id="tbody-result">
            <tr>

            </tr>

        </tbody>
    </table>
</div>

</#macro>


