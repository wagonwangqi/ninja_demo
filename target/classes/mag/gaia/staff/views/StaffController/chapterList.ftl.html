<#include "/mag/gaia/staff/views/layout/staff_layout.ftl.html" />
<#macro title>StaffDashbard</#macro>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <script>
        $("#tableType").change(function () {
            let val = $(this).val();
            $("#tbody-result").find("tr").remove();
            let tbody=window.document.getElementById("tbody-result");
            let but=window.document.getElementById("but");
            but.innerHTML="<a href='/staff/addChapter/"+val+"/${session.id}'>添加章节</a>"
            $.ajax({
                async: false,
                url: "/staff/getChapter/"+${session.id}+"",
                type: "POST",
                data: {
                    "courseId": val
                },
                success: function (data) {
                   let jsons=data.chapterList;
                    let str="";
                    for(let i in jsons){
                        str+="<tr>"+
                            "<td>"+jsons[i].id+"</td>"+
                            "<td>"+jsons[i].chapterName+"</td>"+
                            "<td>"+"<a href='/staff/editChapterName/"+jsons[i].id+"/${session.id}'>编辑</a>"+"</td>"+
                            "<td>"+"<a href='/staff/editSection/"+jsons[i].id+"/${session.id}'>编辑</a>"+"</td>"+
                            "<td>"+"<a href='/staff/editHomework/"+jsons[i].id+"/${session.id}'>编辑</a>"+"</td>"+
                            "</tr>";
                    }
                    tbody.innerHTML =str;
                },
                error: function () {
                    console.log("failed");
                }
            });
        });
    </script>

</head>
<#macro body>
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">章目管理</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
            <select id="tableType" >
                <option selected="selected">请选择课程</option>
                <#list courseList as courses>
                <option value="${courses.couId}">${courses.couName}</option>
                </#list>
            </select>
            <button type="button" class="btn btn-sm btn-outline-secondary" id="but">添加章节</button>
        </div>
    </div>
</div>
<div class="table-responsive">
    <table class="table table-striped table-sm"  id="table-result">
        <thead>
        <tr>
            <th>章目编号</th>
            <th>章目名称</th>
            <th>编辑名称</th>
            <th>编辑节次</th>
            <th>编辑作业</th>
        </tr>
        </thead>
        <tbody  id="tbody-result">
        <#list chapterList as chapter>
        <tr>
            <td>${chapter.id}</td>
            <td>${chapter.chapterName}</td>
            <td><a href="/staff/editChapterName/${chapter.id}/${session.id}">编辑</a></td>
            <td><a href="/staff/editSection/${chapter.id}/${session.id}">编辑</a></td>
            <td><a href="/staff/editHomework/${chapter.id}/${session.id}">编辑</a></td>
        </tr>
        </#list>
        </tbody>
    </table>
</div>

</#macro>


